# LDAP Integration Documentation

## üéØ –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å LDAP API –æ—Ç TIUE. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫—É—Ä—Å–æ–≤, –æ—Ü–µ–Ω–æ–∫ –∏ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑ LDAP —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑ `https://my.tiue.uz`.

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Backend (Django)
- **–ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä**: Django —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø—Ä–æ–∫—Å–∏ –º–µ–∂–¥—É –º–æ–±–∏–ª—å–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ LDAP API
- **–ë–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ LDAP
- **Bearer —Ç–æ–∫–µ–Ω—ã**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è JWT —Ç–æ–∫–µ–Ω—ã –æ—Ç LDAP –≤–º–µ—Å—Ç–æ Django Token

### Frontend (React Native)
- **LDAP Auth Service**: –ü—Ä—è–º–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å LDAP API
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤**: –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ access token
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ—Ñ–∏–ª—å –∏ –∫—É—Ä—Å—ã –∫–µ—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üîë –¢–æ–∫–µ–Ω—ã

### Access Token
- **–¢–∏–ø**: JWT
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏**: 15 –º–∏–Ω—É—Ç
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: Bearer –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### Refresh Token
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏**: 30 –¥–Ω–µ–π
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ü—Ä–∏ refresh –ø–æ–ª—É—á–∞–µ—à—å –Ω–æ–≤—ã–π access + –Ω–æ–≤—ã–π refresh —Ç–æ–∫–µ–Ω

## üì° API Endpoints

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```
POST /api/auth/login/
Body: {"username": "U22312", "password": "password"}
Response: {"access_token": "...", "refresh_token": "...", "user": {...}}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
```
POST /api/auth/refresh/
Body: {"refresh_token": "..."}
Response: {"access_token": "...", "refresh_token": "..."}
```

### –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```
POST /api/auth/profile/
Headers: Authorization: Bearer <token>
Response: {"jshr": "...", "full_name": "...", "group": "...", ...}
```

### –ê–∫—Ç–∏–≤–Ω—ã–µ –∫—É—Ä—Å—ã
```
GET /api/auth/courses/?lang=en&page=1&pageSize=10
Headers: Authorization: Bearer <token>
Response: {"count": 28, "data": [...]}
```

### –û—Ü–µ–Ω–∫–∏
```
GET /api/auth/grades/
Headers: Authorization: Bearer <token>
Response: [...]
```

### –ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å
```
GET /api/auth/attendance/
Headers: Authorization: Bearer <token>
Response: [...]
```

### –°–æ–æ–±—â–µ–Ω–∏—è
```
POST /api/auth/messages/
Headers: Authorization: Bearer <token>
Response: [...]
```

## üöÄ –ó–∞–ø—É—Å–∫

### Backend
```bash
cd backend
pip install -r requirements.txt
python manage.py runserver 0.0.0.0:8000
```

### Frontend
```bash
npm install
npm start
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–¢–æ–∫–µ–Ω—ã –≤ AsyncStorage**: –í—Å–µ —Ç–æ–∫–µ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –¢–æ–∫–µ–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏
3. **Bearer –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Bearer —Ç–æ–∫–µ–Ω—ã
4. **–û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ logout**: –í—Å–µ —Ç–æ–∫–µ–Ω—ã —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ

## üì± –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –ü–æ–ª–µ **Username** –≤–º–µ—Å—Ç–æ Email (–Ω–∞–ø—Ä–∏–º–µ—Ä: U22312)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

### –ü—Ä–æ—Ñ–∏–ª—å
- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ LDAP –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞

### –ö—É—Ä—Å—ã
- –ê–∫—Ç–∏–≤–Ω—ã–µ, –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∏ –±—É–¥—É—â–∏–µ –∫—É—Ä—Å—ã
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
- –°—Ç–∞—Ç—É—Å—ã: current, past, future

## üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

1. **401 Unauthorized**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
2. **503 Service Unavailable**: –°–µ—Ä–≤–µ—Ä LDAP –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
3. **Network errors**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
4. **Token refresh failed**: –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ª–æ–≥–∏–Ω

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- **Username**: U22312
- **Password**: rustam312

### –ü—Ä–æ–≤–µ—Ä–∫–∞ endpoints
```bash
# –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
curl -X POST http://localhost:8000/api/auth/login/ \
  -H "Content-Type: application/json" \
  -d '{"username":"U22312","password":"rustam312"}'

# –¢–µ—Å—Ç –ø—Ä–æ—Ñ–∏–ª—è
curl -X POST http://localhost:8000/api/auth/profile/ \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### Environment Variables
```bash
# Backend
LDAP_BASE_URL=https://my.tiue.uz
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1

# Frontend
# –í config/environment.ts
LDAP_BASE_URL=https://my.tiue.uz
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ Backend
- –í—Å–µ LDAP –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –û—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤

### –õ–æ–≥–∏ Frontend
- –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ development —Ä–µ–∂–∏–º–µ
- –û—à–∏–±–∫–∏ —Å–µ—Ç–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **Offline —Ä–µ–∂–∏–º**: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
2. **Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LDAP —Å–æ–±—ã—Ç–∏—è–º–∏  
3. **–ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: Touch/Face ID –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
4. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–µ

## üÜò Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —É–¥–∞–µ—Ç—Å—è –≤–æ–π—Ç–∏
- –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å username (U22312, –Ω–µ email)
- –£–±–µ–¥–∏—Å—å —á—Ç–æ LDAP —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ backend –Ω–∞ –æ—à–∏–±–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–æ–∫–µ–Ω –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ refresh_token –Ω–µ –∏—Å—Ç–µ–∫ (30 –¥–Ω–µ–π)
- –£–±–µ–¥–∏—Å—å —á—Ç–æ LDAP API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π refresh_token
- –û—á–∏—Å—Ç–∏ AsyncStorage –∏ –≤–æ–π–¥–∏ –∑–∞–Ω–æ–≤–æ

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ access_token –≤–∞–ª–∏–¥–Ω—ã–π
- –£–±–µ–¥–∏—Å—å —á—Ç–æ LDAP API /mobile/data-student-profile —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å Bearer –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ backend –∏ frontend
2. –£–±–µ–¥–∏—Å—å —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å my.tiue.uz
4. –û—á–∏—Å—Ç–∏ –∫–µ—à –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
